<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Sandbox - Architecture & Data Flow Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #eee;
            padding: 40px 20px;
            min-height: 100vh;
        }

        h1 {
            text-align: center;
            margin-bottom: 10px;
            color: #4cc9f0;
            font-size: 28px;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
        }

        .diagram-section {
            max-width: 1100px;
            margin: 0 auto 60px;
        }

        .section-title {
            color: #4cc9f0;
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2d4a6f;
        }

        /* Architecture Diagram */
        .architecture {
            display: flex;
            flex-direction: column;
            gap: 30px;
            padding: 30px;
            background: #16213e;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .arch-layer {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .arch-box {
            background: #0f3460;
            border-radius: 12px;
            padding: 20px;
            min-width: 180px;
            text-align: center;
            position: relative;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .arch-box:hover {
            border-color: #4cc9f0;
            transform: translateY(-5px);
        }

        .arch-box.primary {
            background: linear-gradient(135deg, #4cc9f0 0%, #3a9ec9 100%);
            color: #1a1a2e;
        }

        .arch-box.secondary {
            background: linear-gradient(135deg, #7b2cbf 0%, #5a189a 100%);
        }

        .arch-box.storage {
            background: linear-gradient(135deg, #38b000 0%, #2d8000 100%);
        }

        .arch-box h4 {
            font-size: 14px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .arch-box p {
            font-size: 12px;
            opacity: 0.8;
        }

        .arch-box .icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        /* Connector Lines */
        .connectors {
            display: flex;
            justify-content: center;
            gap: 100px;
            position: relative;
        }

        .connector {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #4cc9f0;
        }

        .connector .arrow {
            font-size: 24px;
        }

        .connector .label {
            font-size: 10px;
            color: #888;
            background: #1a1a2e;
            padding: 2px 8px;
            border-radius: 4px;
        }

        /* Data Flow Diagram */
        .data-flow {
            background: #16213e;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .flow-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            padding: 20px 0;
        }

        .flow-step {
            background: #0f3460;
            border-radius: 10px;
            padding: 15px 20px;
            text-align: center;
            min-width: 140px;
        }

        .flow-step.highlight {
            background: linear-gradient(135deg, #4cc9f0 0%, #3a9ec9 100%);
            color: #1a1a2e;
        }

        .flow-step .step-num {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .flow-step .step-title {
            font-size: 12px;
            font-weight: 600;
        }

        .flow-step .step-desc {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 5px;
        }

        .flow-arrow {
            color: #4cc9f0;
            font-size: 24px;
        }

        /* Component Details */
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .component-card {
            background: #16213e;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .component-card h4 {
            color: #4cc9f0;
            margin-bottom: 15px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .component-card h4 .badge {
            font-size: 10px;
            background: #0f3460;
            padding: 3px 8px;
            border-radius: 4px;
            color: #888;
        }

        .component-card ul {
            list-style: none;
            font-size: 13px;
            color: #aaa;
        }

        .component-card li {
            padding: 8px 0;
            border-bottom: 1px solid #2d4a6f;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .component-card li:last-child {
            border-bottom: none;
        }

        .component-card li::before {
            content: 'â†’';
            color: #4cc9f0;
        }

        /* State Diagram */
        .state-diagram {
            background: #16213e;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .states-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            padding: 20px;
        }

        .state-node {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            border: 3px solid;
            position: relative;
        }

        .state-node.idle {
            border-color: #888;
            background: #1a1a2e;
        }

        .state-node.editing {
            border-color: #4cc9f0;
            background: rgba(76, 201, 240, 0.1);
        }

        .state-node.updating {
            border-color: #f7df1e;
            background: rgba(247, 223, 30, 0.1);
        }

        .state-node.error {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.1);
        }

        .state-node .state-name {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 5px;
        }

        .state-node .state-desc {
            font-size: 10px;
            color: #888;
        }

        .state-arrow {
            color: #4cc9f0;
            font-size: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .state-arrow .trigger {
            font-size: 9px;
            color: #888;
            background: #1a1a2e;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 2px;
        }

        /* Legend */
        .legend {
            margin-top: 30px;
            padding: 20px;
            background: #0f3460;
            border-radius: 8px;
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #aaa;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>Frontend Sandbox - Architecture Diagram</h1>
    <p class="subtitle">åº”ç”¨æ¶æ„ä¸æ•°æ®æµå›¾ | MVP Version</p>

    <!-- Architecture Overview -->
    <div class="diagram-section">
        <h2 class="section-title">1. System Architecture / ç³»ç»Ÿæ¶æ„</h2>
        <div class="architecture">
            <!-- User Layer -->
            <div class="arch-layer">
                <div class="arch-box primary">
                    <div class="icon">ğŸ‘¤</div>
                    <h4>User</h4>
                    <p>å‰ç«¯å¼€å‘è€…</p>
                </div>
            </div>

            <div class="connectors">
                <div class="connector">
                    <span class="arrow">â†“</span>
                    <span class="label">äº¤äº’</span>
                </div>
            </div>

            <!-- UI Layer -->
            <div class="arch-layer">
                <div class="arch-box">
                    <div class="icon">ğŸ“</div>
                    <h4>File Explorer</h4>
                    <p>æ–‡ä»¶åˆ—è¡¨ç®¡ç†</p>
                </div>
                <div class="arch-box">
                    <div class="icon">ğŸ“</div>
                    <h4>Monaco Editor</h4>
                    <p>ä»£ç ç¼–è¾‘å™¨</p>
                </div>
                <div class="arch-box">
                    <div class="icon">ğŸ‘ï¸</div>
                    <h4>Preview Panel</h4>
                    <p>å®æ—¶é¢„è§ˆçª—å£</p>
                </div>
                <div class="arch-box">
                    <div class="icon">ğŸ’»</div>
                    <h4>Console</h4>
                    <p>æ§åˆ¶å°è¾“å‡º</p>
                </div>
            </div>

            <div class="connectors">
                <div class="connector">
                    <span class="arrow">â†“</span>
                    <span class="label">çŠ¶æ€æ›´æ–°</span>
                </div>
                <div class="connector">
                    <span class="arrow">â†‘</span>
                    <span class="label">äº‹ä»¶è§¦å‘</span>
                </div>
            </div>

            <!-- State Layer -->
            <div class="arch-layer">
                <div class="arch-box secondary">
                    <div class="icon">ğŸ”„</div>
                    <h4>State Manager</h4>
                    <p>åº”ç”¨çŠ¶æ€ç®¡ç†</p>
                </div>
                <div class="arch-box secondary">
                    <div class="icon">ğŸ“¨</div>
                    <h4>Event Bus</h4>
                    <p>ç»„ä»¶é—´é€šä¿¡</p>
                </div>
            </div>

            <div class="connectors">
                <div class="connector">
                    <span class="arrow">â†“</span>
                    <span class="label">è¯»/å†™</span>
                </div>
            </div>

            <!-- Storage Layer -->
            <div class="arch-layer">
                <div class="arch-box storage">
                    <div class="icon">ğŸ’¾</div>
                    <h4>Virtual File System</h4>
                    <p>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</p>
                </div>
                <div class="arch-box storage">
                    <div class="icon">ğŸ—ƒï¸</div>
                    <h4>localStorage</h4>
                    <p>æŒä¹…åŒ–å­˜å‚¨</p>
                </div>
            </div>

            <div class="connectors">
                <div class="connector">
                    <span class="arrow">â†“</span>
                    <span class="label">postMessage</span>
                </div>
            </div>

            <!-- Sandbox Layer -->
            <div class="arch-layer">
                <div class="arch-box">
                    <div class="icon">ğŸ”’</div>
                    <h4>iframe Sandbox</h4>
                    <p>å®‰å…¨éš”ç¦»æ‰§è¡Œç¯å¢ƒ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Flow -->
    <div class="diagram-section">
        <h2 class="section-title">2. Real-time Preview Data Flow / å®æ—¶é¢„è§ˆæ•°æ®æµ</h2>
        <div class="data-flow">
            <div class="flow-container">
                <div class="flow-step highlight">
                    <div class="step-num">1</div>
                    <div class="step-title">User Input</div>
                    <div class="step-desc">ç”¨æˆ·ç¼–è¾‘ä»£ç </div>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <div class="step-num">2</div>
                    <div class="step-title">onChange</div>
                    <div class="step-desc">Monaco è§¦å‘äº‹ä»¶</div>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <div class="step-num">3</div>
                    <div class="step-title">Debounce</div>
                    <div class="step-desc">é˜²æŠ– 300ms</div>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <div class="step-num">4</div>
                    <div class="step-title">Update VFS</div>
                    <div class="step-desc">æ›´æ–°è™šæ‹Ÿæ–‡ä»¶</div>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step">
                    <div class="step-num">5</div>
                    <div class="step-title">Generate HTML</div>
                    <div class="step-desc">åˆå¹¶æ–‡ä»¶å†…å®¹</div>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-step highlight">
                    <div class="step-num">6</div>
                    <div class="step-title">Render</div>
                    <div class="step-desc">iframe æ¸²æŸ“</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Component Details -->
    <div class="diagram-section">
        <h2 class="section-title">3. Component Responsibilities / ç»„ä»¶èŒè´£</h2>
        <div class="components-grid">
            <div class="component-card">
                <h4>ğŸ“ FileExplorer <span class="badge">UI</span></h4>
                <ul>
                    <li>æ˜¾ç¤ºé¡¹ç›®æ–‡ä»¶æ ‘ç»“æ„</li>
                    <li>å¤„ç†æ–‡ä»¶é€‰æ‹©/åˆ‡æ¢äº‹ä»¶</li>
                    <li>æ”¯æŒæ–°å»º/é‡å‘½å/åˆ é™¤æ“ä½œ</li>
                    <li>æ˜¾ç¤ºæ–‡ä»¶ç±»å‹å›¾æ ‡</li>
                    <li>é«˜äº®å½“å‰æ´»åŠ¨æ–‡ä»¶</li>
                </ul>
            </div>
            <div class="component-card">
                <h4>ğŸ“ CodeEditor <span class="badge">Core</span></h4>
                <ul>
                    <li>å°è£… Monaco Editor å®ä¾‹</li>
                    <li>ç®¡ç†å¤šæ–‡ä»¶ Tab åˆ‡æ¢</li>
                    <li>ç›‘å¬å†…å®¹å˜åŒ–äº‹ä»¶</li>
                    <li>æä¾›è¯­æ³•é«˜äº®æ”¯æŒ</li>
                    <li>å¤„ç†é”®ç›˜å¿«æ·é”®</li>
                </ul>
            </div>
            <div class="component-card">
                <h4>ğŸ‘ï¸ PreviewPanel <span class="badge">Core</span></h4>
                <ul>
                    <li>åˆ›å»ºå’Œç®¡ç† iframe æ²™ç®±</li>
                    <li>åˆå¹¶ HTML/CSS/JS ç”Ÿæˆé¢„è§ˆ</li>
                    <li>å¤„ç†é¢„è§ˆåˆ·æ–°é€»è¾‘</li>
                    <li>æ•è·å¹¶æ˜¾ç¤ºè¿è¡Œæ—¶é”™è¯¯</li>
                    <li>å®ç°æ— é™å¾ªç¯æ£€æµ‹</li>
                </ul>
            </div>
            <div class="component-card">
                <h4>ğŸ’¾ VirtualFileSystem <span class="badge">Data</span></h4>
                <ul>
                    <li>ç®¡ç†å†…å­˜ä¸­çš„æ–‡ä»¶æ•°æ®</li>
                    <li>æä¾› CRUD æ“ä½œæ¥å£</li>
                    <li>è‡ªåŠ¨åŒæ­¥åˆ° localStorage</li>
                    <li>æ”¯æŒå¯¼å‡ºä¸º ZIP æ ¼å¼</li>
                    <li>åŠ è½½æ—¶æ¢å¤æ–‡ä»¶çŠ¶æ€</li>
                </ul>
            </div>
            <div class="component-card">
                <h4>ğŸ”„ StateManager <span class="badge">State</span></h4>
                <ul>
                    <li>ç®¡ç†å…¨å±€åº”ç”¨çŠ¶æ€</li>
                    <li>å½“å‰æ‰“å¼€çš„æ–‡ä»¶</li>
                    <li>ç¼–è¾‘å™¨é…ç½®é€‰é¡¹</li>
                    <li>UI å¸ƒå±€çŠ¶æ€</li>
                    <li>é”™è¯¯å’ŒåŠ è½½çŠ¶æ€</li>
                </ul>
            </div>
            <div class="component-card">
                <h4>ğŸ“¦ ZipExporter <span class="badge">Util</span></h4>
                <ul>
                    <li>æ”¶é›†æ‰€æœ‰é¡¹ç›®æ–‡ä»¶</li>
                    <li>ä½¿ç”¨ JSZip ç”Ÿæˆå‹ç¼©åŒ…</li>
                    <li>ä¿æŒåŸæœ‰æ–‡ä»¶ç»“æ„</li>
                    <li>è§¦å‘æµè§ˆå™¨ä¸‹è½½</li>
                    <li>æ”¯æŒè‡ªå®šä¹‰æ–‡ä»¶å</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- State Machine -->
    <div class="diagram-section">
        <h2 class="section-title">4. Editor State Machine / ç¼–è¾‘å™¨çŠ¶æ€æœº</h2>
        <div class="state-diagram">
            <div class="states-container">
                <div class="state-node idle">
                    <div class="state-name">IDLE</div>
                    <div class="state-desc">ç­‰å¾…è¾“å…¥</div>
                </div>
                <div class="state-arrow">
                    <span>â†’</span>
                    <span class="trigger">ç”¨æˆ·è¾“å…¥</span>
                </div>
                <div class="state-node editing">
                    <div class="state-name">EDITING</div>
                    <div class="state-desc">ç¼–è¾‘ä¸­</div>
                </div>
                <div class="state-arrow">
                    <span>â†’</span>
                    <span class="trigger">é˜²æŠ–ç»“æŸ</span>
                </div>
                <div class="state-node updating">
                    <div class="state-name">UPDATING</div>
                    <div class="state-desc">æ›´æ–°é¢„è§ˆ</div>
                </div>
                <div class="state-arrow">
                    <span>â†’</span>
                    <span class="trigger">æ¸²æŸ“å®Œæˆ</span>
                </div>
                <div class="state-node idle">
                    <div class="state-name">IDLE</div>
                    <div class="state-desc">ç­‰å¾…è¾“å…¥</div>
                </div>
            </div>
            <div class="states-container" style="margin-top: 20px;">
                <div class="state-node updating">
                    <div class="state-name">UPDATING</div>
                    <div class="state-desc">æ›´æ–°é¢„è§ˆ</div>
                </div>
                <div class="state-arrow">
                    <span>â†’</span>
                    <span class="trigger">è¿è¡Œé”™è¯¯</span>
                </div>
                <div class="state-node error">
                    <div class="state-name">ERROR</div>
                    <div class="state-desc">æ˜¾ç¤ºé”™è¯¯</div>
                </div>
                <div class="state-arrow">
                    <span>â†’</span>
                    <span class="trigger">ç”¨æˆ·ä¿®å¤</span>
                </div>
                <div class="state-node editing">
                    <div class="state-name">EDITING</div>
                    <div class="state-desc">ç¼–è¾‘ä¸­</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Legend -->
    <div class="diagram-section">
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #4cc9f0, #3a9ec9);"></div>
                <span>æ ¸å¿ƒäº¤äº’ç»„ä»¶</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #7b2cbf, #5a189a);"></div>
                <span>çŠ¶æ€ç®¡ç†å±‚</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #38b000, #2d8000);"></div>
                <span>æ•°æ®å­˜å‚¨å±‚</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #0f3460;"></div>
                <span>UI ç»„ä»¶</span>
            </div>
        </div>
    </div>
</body>
</html>
